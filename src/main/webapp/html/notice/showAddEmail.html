<!DOCTYPE html>
<html>
	<head>
	<title></title>
	<meta charset="UTF-8">
		<meta http-equiv="pragma" content="no-cache" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0" />    
		<meta http-equiv="keywords" content="keyword1,keyword2,keyword3" />
		<meta http-equiv="description" content="This is my page" />
		<link href="/css/css.css" type="text/css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="/js/ligerUI/skins/Aqua/css/ligerui-dialog.css"/>
		<link href="/js/ligerUI/skins/ligerui-icons.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="/js/jquery-1.11.0.js"></script>
	    <script type="text/javascript" src="/js/jquery-migrate-1.2.1.js"></script>
		<script src="/js/ligerUI/js/core/base.js" type="text/javascript"></script>
		<script src="/js/ligerUI/js/plugins/ligerDrag.js" type="text/javascript"></script>
		<script src="/js/ligerUI/js/plugins/ligerDialog.js" type="text/javascript"></script>
		<script src="/js/ligerUI/js/plugins/ligerResizable.jss" type="text/javascript"></script>
		<link href="/css/pager.css" type="text/css" rel="stylesheet" />

	</head>
	<body>
		<table width="100%" border="0" cellpadding="0" cellspacing="0">
			 <tr><td height="10"></td></tr>
			 <tr>
			    <td width="15" height="32"><img src="/images/main_locleft.gif" width="15" height="32"></td>
				<td class="main_locbg font2"><img src="/images/pointer.gif">&nbsp;&nbsp;&nbsp;当前位置：公告管理  &gt;  发送邮件</td>
				<td width="15" height="32"><img src="/images/main_locright.gif" width="15" height="32"></td>
			 </tr>
		</table>
	
		 <!-- 请求异常错误  -->
		<table width="100%" height="90%" border="0" cellpadding="10" cellspacing="0" class="main_tabbor">
		  	<tr valign="top">
			    <td>
			    <form enctype="multipart/form-data">
				  <!-- 隐藏表单，flag表示添加标记 -->
    	 			<input type="hidden" name="flag" value="2">
				  <table width="100%" border="0" cellpadding="0" cellspacing="10" class="main_tab">
					    <tr><td class="font3 fftd">
					                接收邮箱<select id="one">

						</select>
					    	  <span style="color: #ff0000;"></span>
					    	</td>
					    </tr>
						<tr><td class="main_tdbor"></td></tr>
						
					    <tr><td class="font3 fftd">
					                邮箱标题：<input type="text" name="title" size="30" id="title"/>
					    	  <span style="color: #ff0000;"></span>
					    	</td>
					    </tr>
						<tr><td class="main_tdbor"></td></tr>
						
						<tr><td class="font3 fftd">邮箱内容：<br/>
							<textarea name="content" cols="88" rows="11" id="content"></textarea>
						</td></tr>
						<tr><td class="main_tdbor"></td></tr>
						<tr>
							<td>
								<input type="file" value="上传附件"name="file" id="file">
							</td>
						</tr>
						<tr><td class="font3 fftd">
								<input type="button" value="发送" id="send">
								<input type="reset" value="重置">
						</td></tr>
						<tr><td class="main_tdbor"></td></tr>
					
				  </table>
				  </form>
				</td>
		  	</tr>
		</table>
		<div style="height:10px;"></div>
	</body>


	<script>
		var str=""
		$.ajax({
			url:"/user/list.do",
			type:"post",
			datatype:"json",
			data:{"page":0,"limit":0},
			success:function (res) {
			var list=res.data
				for(let o in list){
					str+="<option value='"+list[o].id+"'>"+list[o].username+"</option>"
				}
				$("#one").html(str)
			}

		})

		$("#send").click(function () {
			var data = new FormData();
			var  toId=$("#one").val()
			var title=$("#title").val()
			var content=$("#content").val()
			data.append("toId",toId)
			data.append("title",title)
			data.append("content",content)
			data.append("file",$("#file")[0].files[0])

			if (title == "") {
				alert("公告标题不能为空！")
			}
			if($("#file").val()==""){
				alert("文件不能为空")
			}else if(content==""){
				alert("公告内容不能为空！")
			}else {
				$.ajax({
					url:"/email/insert.do",
					type:"post",
					data:data,
					contentType:false,
					processData:false,
					success:function (res) {
						alert("添加成功")
					}

				})
			}

		})
	</script>
</html>